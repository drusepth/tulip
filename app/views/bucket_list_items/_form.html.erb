<%= form_with model: [stay, BucketListItem.new],
             id: "bucket_list_form",
             class: "bucket-list-form",
             data: { controller: "bucket-list-form" } do |f| %>
  <div class="flex gap-2">
    <%= f.text_field :title,
                     placeholder: "Add something...",
                     class: "cozy-input flex-1",
                     required: true,
                     data: { bucket_list_form_target: "titleInput" } %>

    <%= f.select :category,
                 BucketListItem::CATEGORIES.map { |c| [c.titleize, c] },
                 {},
                 class: "cozy-select w-32" %>

    <%= f.submit "Add", class: "btn-primary" %>
  </div>

  <!-- Expandable extra fields -->
  <div class="mt-2">
    <button type="button"
            class="text-sm text-brown-light hover:text-brown flex items-center gap-1 transition-colors"
            data-action="click->bucket-list-form#toggleExpand"
            data-bucket-list-form-target="expandButton">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
      </svg>
      <span data-bucket-list-form-target="expandLabel">Add location or notes</span>
    </button>

    <div class="hidden mt-3 space-y-3" data-bucket-list-form-target="extraFields">
      <div>
        <label class="cozy-label" for="bucket_list_item_address">
          Address (optional)
        </label>
        <%= f.text_field :address,
                         placeholder: "e.g. 123 Main St, San Francisco",
                         class: "cozy-input" %>
      </div>
      <div>
        <label class="cozy-label" for="bucket_list_item_notes">
          Notes (optional)
        </label>
        <%= f.text_area :notes,
                        placeholder: "Any additional details...",
                        rows: 2,
                        class: "cozy-textarea" %>
      </div>
    </div>
  </div>
<% end %>
