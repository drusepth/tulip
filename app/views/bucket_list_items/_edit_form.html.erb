<% stay = bucket_list_item.stay %>
<% search_url = mention_search_stay_path(stay) %>
<%= turbo_frame_tag dom_id(bucket_list_item) do %>
  <div class="bucket-list-item my-2 p-4 rounded-2xl bg-rose-light border border-taupe-light shadow-sm">
    <%= form_with model: [stay, bucket_list_item],
                  class: "space-y-4" do |f| %>
      <!-- Title field -->
      <div class="relative"
           <% if search_url %>
           data-controller="place-mention"
           data-place-mention-search-url-value="<%= search_url %>"
           <% end %>>
        <label class="text-xs text-brown-light mb-1 block">What do you want to do here?</label>
        <%= f.text_field :title,
                         placeholder: "e.g. Try the famous ramen",
                         class: "w-full px-3 py-2 border border-taupe-light rounded-lg bg-cream text-brown text-sm placeholder-brown-lighter focus:outline-none focus:border-sage",
                         autofocus: true,
                         data: search_url ? { place_mention_target: "textarea", action: "input->place-mention#onInput keydown->place-mention#onKeydown" } : {} %>
        <% if search_url %>
          <div class="mention-dropdown hidden" data-place-mention-target="dropdown"></div>
        <% end %>
      </div>

      <!-- Optional fields -->
      <div class="space-y-3 pt-2">
        <div>
          <label class="text-xs text-brown-light mb-1 block">Location</label>
          <%= f.text_field :address,
                           placeholder: "e.g. 123 Main St, San Francisco",
                           class: "w-full px-3 py-2 border border-taupe-light rounded-lg bg-cream text-brown text-sm placeholder-brown-lighter focus:outline-none focus:border-sage" %>
        </div>

        <div>
          <label class="text-xs text-brown-light mb-1 block">Notes</label>
          <%= f.text_area :notes,
                          placeholder: "Any details to remember...",
                          rows: 2,
                          class: "w-full px-3 py-2 border border-taupe-light rounded-lg bg-cream text-brown text-sm placeholder-brown-lighter focus:outline-none focus:border-sage resize-none" %>
        </div>
      </div>

      <div class="flex gap-2 justify-end pt-1">
        <%= link_to "Cancel",
                    stay_path(bucket_list_item.stay),
                    class: "text-sm text-brown-light hover:text-brown px-3 py-1.5 transition-colors",
                    data: { turbo_stream: true } %>
        <%= f.submit "Save", class: "btn-primary text-sm py-1.5 px-4" %>
      </div>
    <% end %>
  </div>
<% end %>
