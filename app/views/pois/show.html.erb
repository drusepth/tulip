<% content_for(:title) { "#{@poi.name || 'Place'} - Tulip" } %>

<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <!-- Navigation: Back + Prev/Next -->
  <div class="mb-6 flex items-center justify-between">
    <%= link_to browse_stay_pois_path(@stay, category: @poi.category), class: "text-sage-dark hover:text-sage inline-flex items-center" do %>
      <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
      </svg>
      Back to <%= @poi.category.titleize %>
    <% end %>

    <div class="flex items-center gap-2">
      <% if @prev_poi %>
        <%= link_to stay_poi_path(@stay, @prev_poi), class: "inline-flex items-center gap-1 px-3 py-1.5 rounded-full text-sm text-brown-light hover:text-brown bg-white border border-taupe-light hover:border-taupe transition-colors" do %>
          <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
          Prev
        <% end %>
      <% end %>
      <% if @next_poi %>
        <%= link_to stay_poi_path(@stay, @next_poi), class: "inline-flex items-center gap-1 px-3 py-1.5 rounded-full text-sm text-brown-light hover:text-brown bg-white border border-taupe-light hover:border-taupe transition-colors" do %>
          Next
          <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        <% end %>
      <% end %>
    </div>
  </div>

  <!-- Hero Section -->
  <div class="cozy-card overflow-hidden mb-8">
    <% hero_photo = @poi.foursquare_photo_url.presence || @poi.wikidata_image_url.presence %>
    <% if hero_photo %>
      <div class="relative h-56 sm:h-72 warm-overlay">
        <%= image_tag hero_photo, class: "w-full h-full object-cover", alt: @poi.name %>
        <div class="absolute inset-0 bg-gradient-to-t from-black to-transparent" style="opacity: 0.4;"></div>
        <div class="absolute bottom-0 left-0 right-0 p-6">
          <div class="flex items-center gap-2 mb-2">
            <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-white text-brown">
              <%= category_icon(@poi.category, size: "w-3.5 h-3.5") %>
              <span class="ml-1"><%= @poi.category.titleize %></span>
            </span>
          </div>
          <h1 class="text-2xl sm:text-3xl font-bold text-white" style="text-shadow: 0 2px 8px rgba(0,0,0,0.4);"><%= @poi.name || 'Unnamed Place' %></h1>
        </div>
      </div>
    <% else %>
      <div class="relative h-44 sm:h-52 bg-gradient-to-br from-sage-light via-cream to-lavender-light">
        <div class="absolute inset-0 flex items-center justify-center">
          <div class="w-20 h-20 rounded-full bg-white flex items-center justify-center shadow-cozy" style="opacity: 0.9;">
            <%= category_icon(@poi.category, size: "w-10 h-10 text-sage-dark") %>
          </div>
        </div>
      </div>
      <div class="px-6 pt-5">
        <div class="flex items-center gap-2 mb-2">
          <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-sage-light text-sage-dark">
            <%= category_icon(@poi.category, size: "w-3.5 h-3.5") %>
            <span class="ml-1"><%= @poi.category.titleize %></span>
          </span>
        </div>
        <h1 class="text-2xl sm:text-3xl font-bold text-brown"><%= @poi.name || 'Unnamed Place' %></h1>
      </div>
    <% end %>

    <!-- Quick Info Bar -->
    <div class="px-6 py-4 flex flex-wrap items-center gap-4 border-b border-taupe-light">
      <% if @poi.distance_meters.present? %>
        <div class="flex items-center gap-1.5 text-brown-light">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
          </svg>
          <span><%= format_distance(@poi.distance_meters) %> from stay</span>
        </div>
      <% end %>
      <% if @poi.cuisine.present? %>
        <div class="flex items-center gap-1.5 text-brown-light">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
          </svg>
          <span><%= @poi.cuisine.gsub(';', ', ').titleize %></span>
        </div>
      <% end %>
      <% badges = poi_amenity_badges(@poi) %>
      <% badges.each do |badge| %>
        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs bg-lavender-light text-lavender-dark font-medium">
          <%= badge[:label] %>
        </span>
      <% end %>
    </div>

    <!-- Foursquare Tip -->
    <% if @poi.foursquare_tip.present? %>
      <div class="px-6 py-4 border-b border-taupe-light bg-cream">
        <div class="flex items-start gap-3">
          <svg class="w-5 h-5 text-sage-dark flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 24 24">
            <path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z"/>
          </svg>
          <p class="text-brown italic leading-relaxed"><%= @poi.foursquare_tip %></p>
        </div>
      </div>
    <% end %>

    <!-- Actions: Favorite + Bucket List + Directions -->
    <div class="px-6 py-4 flex flex-wrap items-center gap-3">
      <%= render "pois/favorite_button", poi: @poi, stay: @stay %>

      <%= button_to stay_bucket_list_items_path(@stay),
                    method: :post,
                    params: { bucket_list_item: { title: @poi.name, address: @poi.address }, source_poi_id: @poi.id },
                    class: "btn-primary gap-2",
                    data: {
                      controller: "loading-button",
                      action: "click->loading-button#start"
                    } do %>
        <svg data-loading-button-target="icon" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
        </svg>
        <svg data-loading-button-target="spinner" class="hidden w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        Add to Bucket List
      <% end %>

      <% if @poi.latitude.present? && @poi.longitude.present? %>
        <a href="https://www.google.com/maps/dir/?api=1&destination=<%= @poi.latitude %>,<%= @poi.longitude %>"
           target="_blank" rel="noopener noreferrer"
           class="btn-outline gap-2">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
          </svg>
          Get Directions
        </a>
      <% end %>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <!-- Main Content (2/3) -->
    <div class="lg:col-span-2 space-y-6">
      <!-- Details Card -->
      <div class="cozy-card p-6">
        <h2 class="text-lg font-semibold text-brown mb-4 flex items-center gap-2">
          <svg class="w-5 h-5 text-sage-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          Details
        </h2>

        <% if poi_has_details?(@poi) %>
          <dl class="space-y-4">
            <% if @poi.address.present? %>
              <div class="flex items-start gap-3">
                <dt class="flex-shrink-0 w-24 text-sm font-medium text-brown-light">Address</dt>
                <dd class="text-brown"><%= @poi.address %></dd>
              </div>
            <% end %>

            <% if @poi.opening_hours.present? %>
              <div class="flex items-start gap-3">
                <dt class="flex-shrink-0 w-24 text-sm font-medium text-brown-light">Hours</dt>
                <dd>
                  <% format_opening_hours(@poi.opening_hours).each do |line| %>
                    <p class="text-brown"><%= line %></p>
                  <% end %>
                </dd>
              </div>
            <% end %>

            <% if @poi.phone.present? %>
              <div class="flex items-start gap-3">
                <dt class="flex-shrink-0 w-24 text-sm font-medium text-brown-light">Phone</dt>
                <dd>
                  <a href="tel:<%= @poi.phone %>" class="text-sage-dark hover:text-sage inline-flex items-center gap-1">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                    </svg>
                    <%= format_phone(@poi.phone) %>
                  </a>
                </dd>
              </div>
            <% end %>

            <% if @poi.website.present? %>
              <div class="flex items-start gap-3">
                <dt class="flex-shrink-0 w-24 text-sm font-medium text-brown-light">Website</dt>
                <dd>
                  <a href="<%= @poi.website %>" target="_blank" rel="noopener noreferrer" class="text-sage-dark hover:text-sage inline-flex items-center gap-1">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                    </svg>
                    <%= format_website_domain(@poi.website) %>
                  </a>
                </dd>
              </div>
            <% end %>

            <% if @poi.brand.present? %>
              <div class="flex items-start gap-3">
                <dt class="flex-shrink-0 w-24 text-sm font-medium text-brown-light">Brand</dt>
                <dd class="text-brown"><%= @poi.brand %></dd>
              </div>
            <% end %>

            <% if @poi.description.present? %>
              <div class="flex items-start gap-3">
                <dt class="flex-shrink-0 w-24 text-sm font-medium text-brown-light">Description</dt>
                <dd class="text-brown"><%= @poi.description %></dd>
              </div>
            <% end %>
          </dl>
        <% else %>
          <div class="text-center py-6">
            <div class="w-12 h-12 rounded-full bg-taupe-light flex items-center justify-center mx-auto mb-3">
              <svg class="w-6 h-6 text-taupe" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </div>
            <p class="text-brown-light">No additional details available for this place.</p>
            <p class="text-sm text-taupe mt-1">Details come from OpenStreetMap contributors and may not be complete.</p>
          </div>
        <% end %>
      </div>

      <!-- Wikipedia Extract -->
      <% if @poi.wikipedia_extract.present? %>
        <div class="cozy-card p-6">
          <h2 class="text-lg font-semibold text-brown mb-4 flex items-center gap-2">
            <svg class="w-5 h-5 text-sage-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
            </svg>
            About
          </h2>
          <p class="text-brown leading-relaxed"><%= @poi.wikipedia_extract %></p>
          <% if @poi.wikipedia_url.present? %>
            <a href="<%= @poi.wikipedia_url %>" target="_blank" rel="noopener noreferrer"
               class="inline-flex items-center gap-1.5 mt-4 text-sm text-sage-dark hover:text-sage transition-colors">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
              </svg>
              Read more on Wikipedia
            </a>
          <% end %>
        </div>
      <% end %>

      <!-- Map with both POI and Stay markers -->
      <% if @poi.latitude.present? && @poi.longitude.present? %>
        <div class="cozy-card p-6">
          <h2 class="text-lg font-semibold text-brown mb-4 flex items-center gap-2">
            <svg class="w-5 h-5 text-sage-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path>
            </svg>
            Location
          </h2>
          <% if @stay.latitude.present? && @stay.longitude.present? %>
            <div class="h-64 rounded-2xl"
                 data-controller="poi-map"
                 data-poi-map-poi-lat-value="<%= @poi.latitude %>"
                 data-poi-map-poi-lng-value="<%= @poi.longitude %>"
                 data-poi-map-poi-name-value="<%= @poi.name %>"
                 data-poi-map-stay-lat-value="<%= @stay.latitude %>"
                 data-poi-map-stay-lng-value="<%= @stay.longitude %>"
                 data-poi-map-stay-name-value="<%= @stay.title %>">
            </div>
            <div class="flex items-center gap-4 mt-3 text-xs text-brown-light">
              <div class="flex items-center gap-1.5">
                <div class="w-3 h-4 bg-sky-500 rounded-sm"></div>
                <span><%= @poi.name %></span>
              </div>
              <div class="flex items-center gap-1.5">
                <div class="w-3 h-3 bg-sage-dark rounded-full"></div>
                <span><%= @stay.title %></span>
              </div>
            </div>
          <% else %>
            <div class="h-64 rounded-2xl"
                 data-controller="mini-map"
                 data-mini-map-lat-value="<%= @poi.latitude %>"
                 data-mini-map-lng-value="<%= @poi.longitude %>"
                 data-mini-map-title-value="<%= @poi.name %>">
            </div>
          <% end %>
        </div>
      <% end %>

      <!-- Notes -->
      <%= render "pois/notes_section", poi: @poi, stay: @stay %>
    </div>

    <!-- Sidebar (1/3) -->
    <div class="space-y-6">
      <!-- Stay Context Card -->
      <div class="cozy-card p-6">
        <h3 class="text-sm font-medium text-brown-light uppercase tracking-wide mb-3">Nearby Stay</h3>
        <%= link_to stay_path(@stay), class: "group block" do %>
          <p class="font-semibold text-brown group-hover:text-sage-dark transition-colors"><%= @stay.title %></p>
          <p class="text-sm text-brown-light mt-1"><%= [@stay.city, @stay.country].compact.join(', ') %></p>
          <% if @stay.check_in.present? && @stay.check_out.present? %>
            <p class="text-xs text-taupe mt-1"><%= @stay.check_in.strftime('%b %d') %> - <%= @stay.check_out.strftime('%b %d, %Y') %></p>
          <% end %>
        <% end %>
      </div>

      <!-- Foursquare Rating Card -->
      <% if @poi.foursquare_rating.present? %>
        <div class="cozy-card p-6 text-center">
          <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br from-amber-100 to-amber-50 mb-3">
            <span class="text-2xl font-bold text-amber-600"><%= (@poi.foursquare_rating / 2.0).round(1) %></span>
          </div>
          <p class="text-sm text-brown-light">out of 5 on Foursquare</p>
          <div class="flex items-center justify-center gap-0.5 mt-2">
            <% 5.times do |i| %>
              <% filled = (@poi.foursquare_rating / 2.0) > i %>
              <svg class="w-5 h-5 <%= filled ? 'text-amber-400' : 'text-taupe-light' %>" fill="currentColor" viewBox="0 0 24 24">
                <path d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/>
              </svg>
            <% end %>
          </div>
        </div>
      <% end %>

      <!-- Price Level Card -->
      <% if @poi.foursquare_price.present? %>
        <div class="cozy-card p-6 text-center">
          <p class="text-2xl font-bold text-brown mb-1"><%= foursquare_price_display(@poi.foursquare_price) %></p>
          <p class="text-sm text-brown-light">
            <%= case @poi.foursquare_price
                when 1 then 'Budget-friendly'
                when 2 then 'Moderate'
                when 3 then 'Upscale'
                when 4 then 'Splurge'
                end %>
          </p>
        </div>
      <% end %>

      <!-- Wikipedia Card -->
      <% if @poi.wikipedia_url.present? %>
        <div class="cozy-card p-6">
          <h3 class="text-sm font-medium text-brown-light uppercase tracking-wide mb-3">Wikipedia</h3>
          <a href="<%= @poi.wikipedia_url %>" target="_blank" rel="noopener noreferrer"
             class="inline-flex items-center gap-2 text-sage-dark hover:text-sage transition-colors">
            <svg class="w-5 h-5 flex-shrink-0" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12.09 13.119c-.14 1.064-.496 2.2-1.07 3.41-.574 1.21-1.143 2.134-1.706 2.773l-1.068-.362c.11-.307.2-.597.266-.87.068-.272.137-.647.207-1.124.07-.477.109-.964.115-1.462a9.7 9.7 0 00-.148-1.64 7.3 7.3 0 00-.34-1.3l-2.123-5.405-.23.588c-.136.368-.29.754-.463 1.157L4.525 11.1c-.132.36-.224.664-.277.908-.053.243-.073.478-.058.705.015.226.073.47.174.733.1.262.224.505.372.727l-.852.492c-.457-.616-.795-1.273-1.013-1.97-.22-.698-.296-1.41-.228-2.135.067-.726.26-1.424.58-2.093l2.464-5.18L5.696 3.279l.807-.278 3.136 7.976.254-.473c.4-.742.761-1.478 1.085-2.209.324-.73.554-1.265.69-1.604l.927.339c-.282.727-.63 1.494-1.042 2.302-.413.808-.73 1.37-.953 1.687l.47 1.211c.154.394.337.774.547 1.14.21.365.426.653.649.864z"/>
              <path d="M21.226 3.39l-2.14 5.289c-.344.85-.573 1.455-.687 1.818-.114.362-.17.73-.17 1.103 0 .326.036.64.108.94.073.3.178.603.315.91l-.783.499a4.49 4.49 0 01-.76-1.353 4.66 4.66 0 01-.263-1.56 7.66 7.66 0 01.108-1.16l-1.584-4.084-.984 2.132-1.248 2.76-.406-.203c.476-1.032.927-2.08 1.353-3.143.425-1.063.782-2.01 1.07-2.84L16.05 2.2l.861-.33 1.804 4.52L20.348 3l.878.39z"/>
            </svg>
            View Wikipedia article
          </a>
          <% if @poi.wikidata_id.present? %>
            <p class="text-xs text-taupe mt-2"><%= @poi.wikidata_id %></p>
          <% end %>
        </div>
      <% end %>

      <!-- Coordinates Card -->
      <% if @poi.latitude.present? && @poi.longitude.present? %>
        <div class="cozy-card p-6">
          <h3 class="text-sm font-medium text-brown-light uppercase tracking-wide mb-3">Coordinates</h3>
          <p class="text-sm text-brown font-mono"><%= @poi.latitude.round(6) %>, <%= @poi.longitude.round(6) %></p>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Data Sources Footer -->
  <div class="mt-8 pt-6 border-t border-taupe-light">
    <div class="flex flex-wrap items-center gap-x-6 gap-y-2 text-xs text-taupe">
      <span class="flex items-center gap-1">
        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        OpenStreetMap<% if @poi.osm_id.present? %> (<%= @poi.osm_id %>)<% end %>
      </span>
      <% if poi_has_foursquare_data?(@poi) %>
        <span class="flex items-center gap-1">
          <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path>
          </svg>
          Foursquare
        </span>
      <% elsif @poi.foursquare_fetched_at.present? %>
        <span class="flex items-center gap-1">
          Foursquare: no match found
        </span>
      <% end %>
      <% if poi_has_wikidata_data?(@poi) %>
        <span class="flex items-center gap-1">
          <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
          </svg>
          Wikipedia / Wikidata
        </span>
      <% elsif @poi.wikidata_fetched_at.present? %>
        <span class="flex items-center gap-1">
          Wikipedia: no match found
        </span>
      <% end %>
      <% last_updated = [@poi.foursquare_fetched_at, @poi.wikidata_fetched_at].compact.max %>
      <% if last_updated %>
        <span>Updated <%= last_updated.strftime('%b %d, %Y') %></span>
      <% end %>
    </div>
  </div>
</div>
